include:
  - project: 'stream-machine/tools-and-utilities/ci-templates'
    file: '/python/publish.yml'

.python-needs:
  stage: publish
  needs:
    - buf-lint
    - aip-guidelines-lint
    - breaking

python-artifact-test:
  extends:
    - .python-needs
    - .python-artifact-test
  script:
    - make publish-python-test

python-artifact-release:
  extends:
    - .python-needs
    - .python-artifact-release
  script:
    - make publish-python-release

python-public-artifact-test:
  extends:
    - .python-needs
    - .python-public-artifact-test
  script:
    - make publish-public-python-test

python-public-artifact-release:
  stage: publish
  extends:
    - .python-needs
    - .python-public-artifact-release
  script:
    - make publish-public-python-release
